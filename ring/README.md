# Ring
## Introduction
Στον μακρινό Γαλαξία των Αλγορίθμων, υπάρχει ένα ηλιακό σύστημα με Κ πλανήτες στους οποίους κατοικούν ευφυή εξωγήινα όντα! Όλοι οι πλανήτες απέχουν την ίδια απόσταση από τον ήλιο, επομένως μπορούμε να φανταστούμε ότι σχηματίζουν έναν δακτύλιο γύρω από αυτόν.
Οι εξωγήινοι έχουν σχεδιάσει ένα ιεραρχικό δίκτυο μεταφορών που τους επιτρέπει να μετακινούνται μεταξύ των πλανητών. Συγκεκριμένα, στη μεγαλύτερη χώρα κάθε πλανήτη, υπάρχει ένα διαστημοδρόμιο που χρησιμοποιείται για διαστημικές πτήσεις από και προς τους δυο γειτονικούς πλανήτες. Αν δηλαδή αριθμήσουμε τους πλανήτες από το 0 έως το Κ — 1, το διαστημοδρόμιο στον πλανήτη i χρησιμοποιείται για πτήσεις από και προς τους πλανήτες (i — 1) mod Κ και (i +1) mod Κ.
Για τη μετακίνησή τους μεταξύ των χωρών του ίδιου πλανήτη, οι εξωγήινοι έχουν σχεδιάσει οδικά δίκτυα που αντιστοιχούν σε δυαδικά δέντρα (οι κόμβοι του δέντρου αντιστοιχούν στις χώρες του πλανήτη και οι ακμές του δέντρου αντιστοιχούν στους δρόμους). Ρίζα του δέντρου είναι η μεγαλύτερη χώρα του πλανήτη, αυτή δηλαδή όπου βρίσκεται και το διαστημοδρόμιο1.
Ένας πλούσιος κάτοικος αυτοΰ του ηλιακού συστήματος θέλει να κάνει ένα μεγάλο ταξίδι με σκοπό να θαυμάσει τα αξιοθέατα διαφόρων χωρών. Ωστόσο, δεν θέλει να περάσει από την ίδια χώρα δυο φορές, καθώς το θεωρεί χάσιμο χρόνου. Έτσι, το δρομολόγιό του θα δίνεται από ένα απλό μονοπάτι που αρχίζει και τελειώνει σε διαφορετικές χώρες. Γι’ αυτό, αναζητεί το μεγαλύτερο απλό μονοπάτι στο δίκτυο του ηλιακού συστήματος (το μήκος κάθε μονοπατιού είναι ίσο με το πλήθος των ακμών του). 
## What we want
Για να τον βοηθήσετε, πρέπει να γράψετε ένα πρόγραμμα που υπολογίζει το μήκος του μεγαλύτερου απλού μονοπατιού σε ένα τέτοιο δίκτυο.
## Input
Το πρόγραμμά σας θα διαβάζει από το standard input, στην πρώτη γραμμή, έναν θετικό ακέραιο αριθμό Κ που δηλώνει το πλήθος των πλανητών στο ηλιακό σύστημα. Μπορούμε να θεωρήσουμε ότι οι πλανήτες είναι αριθμημένοι διαδοχικά από 0 έως Κ — 1. Στις επόμενες 2Κ γραμμές θα δίνεται η περιγραφή των Κ οδικών δικτύων των πλανητών (με τη μορφή των πινάκων γονέων για τα αντίστοιχα δυαδικά δέντρα). Συγκεκριμένα, στη γραμμή 2* θα δίνεται ένας θετικός ακέραιος Ν{ που δηλώνει το πλήθος των χωρών του πλανήτη i. Στη γραμμή 2i + 1, θα δίνονται Ν{ — 1 φυσικοί αριθμοί που αντιστοιχούν στον πίνακα γονέων του δυαδικού δέντρου του πλανήτη i. Συγκεκριμένα, ως ρίζα θα έχουμε πάντα τη χώρα με αριθμό 1, και δεν θα υπάρχει εγγραφή στον πίνακα γονέων για αυτή. Αν στην ί-οστή θέση, ί = 1,..., Ν{ — 1, δίνεται η τιμή j, αυτό δηλώνει ότι η χώρα ί + 1 του πλανήτη i έχει ως πατέρα στο οδικό του δίκτυο τη χώρα j. Στην περίπτωση που Ν{ = 1, δηλαδή όταν ο πλανήτης i έχει μόνο μία χώρα, τη ρίζα του δέντρου, στη γραμμή 2i + 1 θα υπάρχει η τιμή 0.
## Output
Το πρόγραμμά σας πρέπει να τυπώνει στο standard output (στην πρώτη γραμμή) έναν θετικό ακέραιο που αντιστοιχεί στο μήκος του μεγαλύτερου μονοπατιού στο δίκτυο μεταφορών της εισόδου.